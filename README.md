# ü•∑ UpliftNinja

## ‚úÖ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

## ‚úÖ –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏ uplift –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è

Uplift-–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ - —ç—Ç–æ –∑–∞–¥–∞—á–∞ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –Ω–∞ –æ—Ü–µ–Ω–∫—É **–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–≥–æ —á–∏—Å—Ç–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞** –æ—Ç –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–æ–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏) –Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞. –¶–µ–ª—å - –≤—ã—è–≤–∏—Ç—å —Ç–µ—Ö, –∫—Ç–æ **–æ—Ç–∫–ª–∏–∫–Ω–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è**, –∏ –∏–∑–±–µ–∂–∞—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —Ç–µ–º–∏, –Ω–∞ –∫–æ–≥–æ –æ–Ω–æ –Ω–∏–∫–∞–∫ –Ω–µ –ø–æ–≤–ª–∏—è–µ—Ç –∏–ª–∏ –¥–∞–∂–µ –æ—Ç—Ç–æ–ª–∫–Ω—ë—Ç.

### ü§ó –¢–∏–ø—ã –∫–ª–∏–µ–Ω—Ç–æ–≤

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ –≤—Å–µ –Ω–∞—à–∏ –∫–ª–∏–µ–Ω—Ç—ã –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ –æ–¥–Ω–æ–π –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π:
1. **–ù–µ –±–µ—Å–ø–æ–∫–æ–∏—Ç—å (Do-Not-Disturbs)** ‚Äî —á–µ–ª–æ–≤–µ–∫, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ, –µ—Å–ª–∏ —Å –Ω–∏–º –ø—Ä–æ–∫–æ–º–º—É–Ω–∏—Ü–∏—Ä–æ–≤–∞—Ç—å.
2. **–ü–æ—Ç–µ—Ä—è–Ω–Ω—ã–π (Lost Causes)** ‚Äî —á–µ–ª–æ–≤–µ–∫, –∫–æ—Ç–æ—Ä—ã–π –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Å–æ–≤–µ—Ä—à–∏—Ç —Ü–µ–ª–µ–≤–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ, –≤–Ω–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π. –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —Ç–∞–∫–∏–º–∏ –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –Ω–µ –ø—Ä–∏–Ω–æ—Å–∏—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –¥–æ—Ö–æ–¥–∞, –Ω–æ —Å–æ–∑–¥–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã.
3. **–õ–æ—è–ª—å–Ω—ã–π (Sure Things)** ‚Äî —á–µ–ª–æ–≤–µ–∫, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∏ –Ω–∞ —á—Ç–æ. –≠—Ç–æ —Å–∞–º—ã–π –ª–æ—è–ª—å–Ω—ã–π –≤–∏–¥ –∫–ª–∏–µ–Ω—Ç–æ–≤. –ü–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –ø—É–Ω–∫—Ç–æ–º, —Ç–∞–∫–∏–µ –∫–ª–∏–µ–Ω—Ç—ã —Ç–∞–∫–∂–µ —Ä–∞—Å—Ö–æ–¥—É—é—Ç –±—é–¥–∂–µ—Ç.
4. **–£–±–µ–∂–¥–∞–µ–º—ã–π (Persuadables)** ‚Äî —ç—Ç–æ —á–µ–ª–æ–≤–µ–∫, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ, –Ω–æ –ø—Ä–∏ –µ–≥–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –Ω–µ –≤—ã–ø–æ–ª–Ω–∏–ª –±—ã —Ü–µ–ª–µ–≤–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è. –≠—Ç–æ —Ç–µ –ª—é–¥–∏, –∫–æ—Ç–æ—Ä—ã—Ö –º—ã —Ö–æ—Ç–µ–ª–∏ –±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–∞—à–µ–π –º–æ–¥–µ–ª—å—é, —á—Ç–æ–±—ã —Å –Ω–∏–º–∏ –ø—Ä–æ–∫–æ–º–º—É–Ω–∏—Ü–∏—Ä–æ–≤–∞—Ç—å.

–ü–æ–º–∏–º–æ Uplift –ø–æ–¥—Ö–æ–¥–∞ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –∏ –¥—Ä—É–≥–∏–µ(–Ω–∞–ø—Ä–∏–º–µ—Ä, look-alike, response –º–æ–¥–µ–ª–∏), –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Ä–∞–∑–ª–∏—á–∞—é—Ç —Ç–∏–ø—ã –∫–ª–∏–µ–Ω—Ç–æ–≤, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è —Å–µ—Ä—å–µ–∑–Ω—ã–º –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–æ–º –∏ —Ñ–∞–∫—Ç–æ—Ä–æ–º —Ä–∏—Å–∫–∞ –ø—Ä–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–∏ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã—Ö –∏ –ø–∏–∞—Ä –∫–æ–º–ø–∞–Ω–∏–π.

üí°Uplift-–º–æ–¥–µ–ª–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç **–º–∞–∫—Å–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–±—ã–ª—å** –∏ **–º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–∑–¥–µ—Ä–∂–∫–∏**, –Ω–∞–ø—Ä–∞–≤–ª—è—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—é **—Ç–æ–ª—å–∫–æ –Ω–∞ —É–±–µ–∂–¥–∞–µ–º—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤**.

---

### üìù –§–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∑–∞–¥–∞—á—É

–ü—É—Å—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ $i$ –∏–º–µ–µ–º:
- $X_i$ - –≤–µ–∫—Ç–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤,
- $W_i \in \{0, 1\}$ - —Ñ–ª–∞–≥ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è:
$W_i = 1$ - –∫–ª–∏–µ–Ω—Ç –≤ **treatment**-–≥—Ä—É–ø–ø–µ (–±—ã–ª–æ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ),
$W_i = 0$ - –∫–ª–∏–µ–Ω—Ç –≤ **control**-–≥—Ä—É–ø–ø–µ (–±–µ–∑ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è),
- $Y_i^1$ - –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –æ—Ç–∫–ª–∏–∫ –ø—Ä–∏ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏–∏,
- $Y_i^0$ - –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –æ—Ç–∫–ª–∏–∫ –±–µ–∑ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è.

–ù–∞–±–ª—é–¥–∞–µ–º–∞—è —Ü–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è: $Y_i = W_i Y_i^1 + (1 - W_i) Y_i^0$

**–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –æ—Ç –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è (–¥–∞–ª–µ–µ causal effect)**: $\tau_i = Y_i^1 - Y_i^0$

–ü–æ—Å–∫–æ–ª—å–∫—É –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–∞–±–ª—é–¥–∞—Ç—å $Y_i^1$ –∏ $Y_i^0$ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä: –Ω–µ–ª—å–∑—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–º—Å –∏ –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–º—Å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ), –≤–º–µ—Å—Ç–æ $\tau_i$ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è **Conditional Average Treatment Effect (CATE)**: $\text{uplift}(x) = \widehat{\text{CATE}}(x) = \mathbb{E}[Y \mid X = x, W = 1] - \mathbb{E}[Y \mid X = x, W = 0]$

–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ **—É—Å–ª–æ–≤–∏—è —É—Å–ª–æ–≤–Ω–æ–π –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (CIA)**:
${Y^0, Y^1} \text{ –ù–µ –∑–∞–≤–∏—Å—è—Ç } W(X)$
–¢–æ –µ—Å—Ç—å, –ø—Ä–∏ –∑–∞–¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö $X$, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –∏—Å—Ö–æ–¥–æ–≤ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ñ–∞–∫—Ç–∞ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è.

---

### ‚öôÔ∏è –î–∏–∑–∞–π–Ω —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞

–î–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ **—Ä–∞–Ω–¥–æ–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç**:

1. –°–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º —Ä–∞–∑–¥–µ–ª–∏—Ç—å —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ç–∏–≤–Ω—É—é —á–∞—Å—Ç—å –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –±–∞–∑—ã –Ω–∞:
- **Treatment-–≥—Ä—É–ø–ø—É** ($W = 1$) - –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—é,
- **Control-–≥—Ä—É–ø–ø—É** ($W = 0$) - –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—é.
2. –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–∫–ª–∏–∫ $Y_i$ –¥–ª—è –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ $(X_i, W_i, Y_i)$ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è uplift-–º–æ–¥–µ–ª–∏.

## ‚úÖ –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –ø–æ–¥—Ö–æ–¥—ã

### ‚≠ê –û–¥–Ω–∞ –º–æ–¥–µ–ª—å —Å –ø—Ä–∏–∑–Ω–∞–∫–æ–º –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ (S-Learner)
–ê–ª–≥–æ—Ä–∏—Ç–º:
- –û–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ü–µ–ª–µ–≤–æ–π ($W=1$) –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π ($W=0$) –≥—Ä—É–ø–ø.
- –í –ø—Ä–∏–∑–Ω–∞–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–ª–∞–≥ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è $W_i$.
- –ú–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ $(X_i, W_i)$ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è $Y_i$.
- Uplift –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ —Ä–∞–∑–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π:
  <br>
  $\widehat{\text{uplift}}(x) = \hat{P}(Y=1 \mid X=x, W=1) - \hat{P}(Y=1 \mid X=x, W=0)$
- –í–æ–∑–º–æ–∂–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ: –¥–æ–±–∞–≤–∏—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è $x_{ij} \cdot W_i$.

---

### ‚≠ê –î–≤–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –º–æ–¥–µ–ª–∏ (T-Learner)
–ê–ª–≥–æ—Ä–∏—Ç–º:
- –û–±—É—á–∞—é—Ç—Å—è –¥–≤–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏:
  - $P^T(x) = P(Y=1 \mid X=x, W=1)$ ‚Äî –Ω–∞ —Ü–µ–ª–µ–≤–æ–π –≥—Ä—É–ø–ø–µ,
  - $P^C(x) = P(Y=1 \mid X=x, W=0)$ ‚Äî –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π –≥—Ä—É–ø–ø–µ.
- Uplift:
  <br>
  $\widehat{\text{uplift}}(x) = P^T(x) - P^C(x)$
- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫: –æ—à–∏–±–∫–∏ –æ–±–µ–∏—Ö –º–æ–¥–µ–ª–µ–π —Å—É–º–º–∏—Ä—É—é—Ç—Å—è.

---

### ‚≠ê –î–≤–µ –∑–∞–≤–∏—Å–∏–º—ã–µ –º–æ–¥–µ–ª–∏ (Dependent Feature Representation)
- –°–Ω–∞—á–∞–ª–∞ –æ–±—É—á–∞–µ—Ç—Å—è –º–æ–¥–µ–ª—å –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π –≥—Ä—É–ø–ø–µ: $P^C(x) = P(Y=1 \mid X=x, W=0)$.
- –ï—ë –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è $P^C(x)$ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∫–∞–∫ –ø—Ä–∏–∑–Ω–∞–∫ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ –º–æ–¥–µ–ª–∏ –Ω–∞ —Ü–µ–ª–µ–≤–æ–π –≥—Ä—É–ø–ø–µ:
  <br>
  $P^T(x) = P(Y=1 \mid X=x, P^C(x), W=1)$
- Uplift:
  <br>
  $\widehat{\text{uplift}}(x) = P^T(x, P^C(x)) - P^C(x)$

---

### ‚≠ê X-Learner (–ø–µ—Ä–µ–∫—Ä—ë—Å—Ç–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å)
1. –û–±—É—á–∞—é—Ç—Å—è –±–∞–∑–æ–≤—ã–µ –º–æ–¥–µ–ª–∏:  
   $P^C(x) = P(Y=1 \mid X=x, W=0)$,  
   $P^T(x) = P(Y=1 \mid X=x, W=1)$.
2. –í—ã—á–∏—Å–ª—è—é—Ç—Å—è –≤–º–µ–Ω—ë–Ω–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã:
   <br>
   $\tilde{D}^T_i = Y_i - P^C(X_i) \quad \text{(–¥–ª—è } W_i=1\text{)}$
   <br>
   $\tilde{D}^C_i = P^T(X_i) - Y_i \quad \text{(–¥–ª—è } W_i=0\text{)}$
3. –û–±—É—á–∞—é—Ç—Å—è —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –Ω–∞ $\tilde{D}^T$ –∏ $\tilde{D}^C$:  
   $\mu^T(x) = E[\tilde{D}^T \mid X=x]$,  
   $\mu^C(x) = E[\tilde{D}^C \mid X=x]$.
4. –§–∏–Ω–∞–ª—å–Ω—ã–π uplift ‚Äî –≤–∑–≤–µ—à–µ–Ω–Ω–∞—è —Å—É–º–º–∞:
   <br>
   $\widehat{\text{uplift}}(x) = g(x) \cdot \mu^C(x) + (1 - g(x)) \cdot \mu^T(x)$
   <br>
   –≥–¥–µ $g(x) \in [0,1]$, —á–∞—Å—Ç–æ $g = P(W=0)$ –∏–ª–∏ $g=0/1$ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –≥—Ä—É–ø–ø.

---

### ‚≠ê –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –∫–ª–∞—Å—Å–æ–≤ (Class Transformation)
- –ü—Ä–∏–º–µ–Ω–∏–º–æ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –±–∏–Ω–∞—Ä–Ω–æ–º $Y$ –∏ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–µ: $P(W=1) = P(W=0) = 1/2$.
- –í–≤–æ–¥–∏—Ç—Å—è –Ω–æ–≤–∞—è —Ü–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è:
  <br>
  $Z_i = Y_i \cdot W_i + (1 - Y_i) \cdot (1 - W_i)$
- –¢–æ–≥–¥–∞:
  <br>
  $P(Z_i = 1 \mid X=x) = \frac{1 + \text{uplift}(x)}{2}
  \quad \Rightarrow \quad
  \text{uplift}(x) = 2 \cdot P(Z=1 \mid X=x) - 1$

---

### ‚≠ê –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏—Å—Ö–æ–¥ (Transformed Outcome, —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥)
- –†–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º $Y$ (–Ω–µ —Ç–æ–ª—å–∫–æ –±–∏–Ω–∞—Ä–Ω—ã–º) –∏ –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –≥—Ä—É–ø–ø–∞–º–∏.
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è propensity score: $p = P(W=1 \mid X=x)$ (—á–∞—Å—Ç–æ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ $p = n_T / n$).
- –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ü–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è:
  <br>
  $Z_i = Y_i \cdot \frac{W_i - p}{p(1 - p)}$
- –ü—Ä–∏ —É—Å–ª–æ–≤–∏–∏ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Ä–∞–∑–±–∏–µ–Ω–∏—è:
  <br>
  $\mathbb{E}[Z_i \mid X=x] = \text{uplift}(x)$
- –û–±—É—á–∞–µ—Ç—Å—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è –Ω–∞ $Z_i$ —Å MSE-–ª–æ—Å—Å–æ–º.

## ‚úÖ –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç–æ–¥—ã

### ‚≠ê Uplift-–¥–µ—Ä–µ–≤–æ (Uplift Tree)
- –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Ä–∞–∑–±–∏–≤–∞–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, –º–∞–∫—Å–∏–º–∏–∑–∏—Ä—É—è **—Ä–∞–∑–Ω–æ—Å—Ç—å uplift'–æ–≤** –º–µ–∂–¥—É –ª–µ–≤—ã–º –∏ –ø—Ä–∞–≤—ã–º –ø–æ–¥–¥–µ—Ä–µ–≤—å—è–º–∏.
- –ö—Ä–∏—Ç–µ—Ä–∏–π –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–∞–∑–±–∏–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏–∏ –ö—É–ª—å–±–∞–∫–∞‚Äì–õ–µ–π–±–ª–µ—Ä–∞):
  <br>
  $\Delta = n_{\text{left}} \cdot D(p^T_{\text{left}}, p^C_{\text{left}}) + n_{\text{right}} \cdot D(p^T_{\text{right}}, p^C_{\text{right}})$
  –≥–¥–µ $p^T$, $p^C$ ‚Äî –¥–æ–ª–∏ –æ—Ç–∫–ª–∏–∫–∞ –≤ treatment –∏ control –ø–æ–¥–≤—ã–±–æ—Ä–∫–∞—Ö, –∞ $D(a,b)$ ‚Äî –º–µ—Ä–∞ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è (—á–∞—Å—Ç–æ KL-–¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—è –∏–ª–∏ $\chi^2$).
- –¶–µ–ª—å —Ç–∞–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞: —Å–æ–∑–¥–∞—Ç—å –≥–æ–º–æ–≥–µ–Ω–Ω—ã–µ(–æ–¥–Ω–æ—Ä–æ–¥–Ω—ã–µ) –ø–æ uplift-—É –ª–∏—Å—Ç—å—è.

---

### ‚≠ê Uplift-–ª–µ—Å (Uplift Random Forest)
- –ê–Ω—Å–∞–º–±–ª—å –∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ uplift-–¥–µ—Ä–µ–≤—å–µ–≤.
- –ö–∞–∂–¥–æ–µ –¥–µ—Ä–µ–≤–æ –æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ —Å–ª—É—á–∞–π–Ω–æ–π –ø–æ–¥–≤—ã–±–æ—Ä–∫–µ –æ–±—ä–µ–∫—Ç–æ–≤ –∏/–∏–ª–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.
- –§–∏–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑ ‚Äî —É—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –≤—Å–µ—Ö –¥–µ—Ä–µ–≤—å–µ–≤:
  <br>
  $\widehat{\text{uplift}}(x) = \frac{1}{B} \sum_{b=1}^B \text{uplift}_b(x)$

---

### ‚≠ê –ú–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è –º–æ–¥–µ–ª—å (Generalized Lai Method)
- –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∑–∞–¥–∞—á—É –≤ **–º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤—É—é –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é** —Å 4 –∫–ª–∞—Å—Å–∞–º–∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —Ç–∏–ø–∞–º –∫–ª–∏–µ–Ω—Ç–æ–≤:
  - $Y=1, W=1$ ‚Üí –∫–ª–∞—Å—Å 1 (**Persuadables** –∏–ª–∏ **Sure Things**),
  - $Y=0, W=0$ ‚Üí –∫–ª–∞—Å—Å 2 (**Lost Causes** –∏–ª–∏ **Do-Not-Disturbs**),
  - $Y=0, W=1$ ‚Üí –∫–ª–∞—Å—Å 3 (**Do-Not-Disturbs** –∏–ª–∏ **Lost Causes**),
  - $Y=1, W=0$ ‚Üí –∫–ª–∞—Å—Å 4 (**Sure Things** –∏–ª–∏ **Persuadables**).
- –ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ $P_1, P_2, P_3, P_4$.
- Uplift –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫:
  <br>
  $\widehat{\text{uplift}}(x) = (P_1 - P_3) - (P_4 - P_2) = (P_1 + P_2) - (P_3 + P_4)$
- –ü–æ–¥—Ö–æ–¥ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö —Å –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –±—É—Å—Ç–∏–Ω–≥).

## ‚úÖ Uplift –º–µ—Ç—Ä–∏–∫–∏

### ‚≠ê Uplift@k (–∏–ª–∏ Qini@k)
- –û—Ü–µ–Ω–∏–≤–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ –Ω–∞ **—Ç–æ–ø-k%** –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–º uplift-–æ–º.
- –ü—É—Å—Ç—å –∫–ª–∏–µ–Ω—Ç—ã –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ —É–±—ã–≤–∞–Ω–∏—é $\hat{\tau}(x_i)$.
- –û–±–æ–∑–Ω–∞—á–∏–º:
  - $n_T$, $n_C$ ‚Äî —Ä–∞–∑–º–µ—Ä—ã treatment –∏ control –≥—Ä—É–ø–ø –≤ —Ç–æ–ø–µ,
  - $r_T = \sum_{i \in \text{top}, W_i=1} Y_i$ ‚Äî —á–∏—Å–ª–æ –æ—Ç–∫–ª–∏–∫–Ω—É–≤—à–∏—Ö—Å—è –≤ treatment,
  - $r_C = \sum_{i \in \text{top}, W_i=0} Y_i$ ‚Äî —á–∏—Å–ª–æ –æ—Ç–∫–ª–∏–∫–Ω—É–≤—à–∏—Ö—Å—è –≤ control.
- –¢–æ–≥–¥–∞:
  <br>
  $\text{uplift@k} = \frac{r_T}{n_T} - \frac{r_C}{n_C}$

---

### ‚≠ê Qini-–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç (Qini Coefficient)
- –ê–Ω–∞–ª–æ–≥ AUC –¥–ª—è uplift-–º–æ–¥–µ–ª–µ–π.
- –°—Ç—Ä–æ–∏—Ç—Å—è **Qini-–∫—Ä–∏–≤–∞—è**: –ø–æ –æ—Å–∏ X ‚Äî –¥–æ–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –æ—Ç 0 –¥–æ 1, –ø–æ –æ—Å–∏ Y ‚Äî –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–π uplift:
  <br>
  $Q(q) = r_T(q) - r_C(q) \cdot \frac{n_T(q)}{n_C(q)}$
  –≥–¥–µ $q$ ‚Äî –¥–æ–ª—è –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤, $r_T(q), r_C(q)$ ‚Äî —Å—É–º–º–∞—Ä–Ω—ã–µ –æ—Ç–∫–ª–∏–∫–∏ –≤ treatment/control —Å—Ä–µ–¥–∏ –ø–µ—Ä–≤—ã—Ö $q$ –∫–ª–∏–µ–Ω—Ç–æ–≤.
- Qini-–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç ‚Äî –ø–ª–æ—â–∞–¥—å –º–µ–∂–¥—É Qini-–∫—Ä–∏–≤–æ–π –º–æ–¥–µ–ª–∏ –∏ —Å–ª—É—á–∞–π–Ω–æ–π (baseline):
  <br>
  $\text{Qini} = \int_0^1 \left( Q_{\text{model}}(q) - Q_{\text{random}}(q) \right) dq$
- –î–ª—è —Å–ª—É—á–∞–π–Ω–æ–π –º–æ–¥–µ–ª–∏ $Q_{\text{random}}(q) = 0$ –ø—Ä–∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–µ –≥—Ä—É–ø–ø.

> ‚ùó –ú–µ—Ç—Ä–∏–∫–∏ –¥–æ–ª–∂–Ω—ã –æ—Ü–µ–Ω–∏–≤–∞—Ç—å—Å—è **—Ç–æ–ª—å–∫–æ –Ω–∞ holdout-–≤—ã–±–æ—Ä–∫–µ**, –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –∏–∑ —Ä–∞–Ω–¥–æ–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞, –∏–Ω–∞—á–µ –≤–æ–∑–º–æ–∂–Ω–∞ —É—Ç–µ—á–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.